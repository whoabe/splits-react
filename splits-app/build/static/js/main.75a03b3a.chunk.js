(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{36:function(e,t,a){e.exports=a.p+"static/media/loadingcolorbar.f9a75852.gif"},39:function(e,t,a){e.exports=a(73)},44:function(e,t,a){},45:function(e,t,a){},73:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),r=a(16),i=a.n(r),s=(a(44),a(18)),c=a(13),o=a(7),u=a(8),m=a(9),d=a(12),p=a(10),h=a(6),f=a(11),E=(a(45),function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this.props.remainingItem,t=e.quantity,a=parseFloat((e.price*e.quantity).toFixed(2));return l.a.createElement("tr",null,l.a.createElement("td",null,e.description),l.a.createElement("td",null,t),l.a.createElement("td",null,e.price),l.a.createElement("td",null,a))}}]),t}(l.a.Component)),g=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this,t=this.props.taxRate,a=parseFloat(this.props.remainingItems.map(function(e){return e.quantity*e.price}).reduce(function(e,t){return e+t},0).toFixed(2)),n=parseFloat((a*t/100).toFixed(2)),r=(n+a).toFixed(2),i=this.props.filterText,s=[],c=null;return this.props.remainingItems.forEach(function(t){-1!==t.description.indexOf(i)&&t.description!==c&&(s.push(l.a.createElement(E,{handleInput:e.props.handleInput,remainingItem:t,key:t.itemId})),c=t.description)}),l.a.createElement("div",{className:"userTable"},l.a.createElement("h5",null,"Your Split"),l.a.createElement("table",null,l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"Item"),l.a.createElement("th",null,"Qty"),l.a.createElement("th",null,"Price"),l.a.createElement("th",null,"Subtotal"))),l.a.createElement("tbody",null,s,l.a.createElement("tr",null,l.a.createElement("td",null),l.a.createElement("td",null),l.a.createElement("td",null,"Subtotal"),l.a.createElement("td",{className:"money"},a)),l.a.createElement("tr",null,l.a.createElement("td",null),l.a.createElement("td",null),l.a.createElement("td",null,"Tax (",t,"%)"),l.a.createElement("td",{className:"money"},n)),l.a.createElement("tr",null,l.a.createElement("td",null),l.a.createElement("td",null),l.a.createElement("td",null,"Total"),l.a.createElement("td",{className:"money"},r)))))}}]),t}(l.a.Component),b=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).handleFilterTextChange=a.handleFilterTextChange.bind(Object(h.a)(a)),a}return Object(f.a)(t,e),Object(m.a)(t,[{key:"handleFilterTextChange",value:function(e){this.props.onFilterTextChange(e.target.value)}},{key:"render",value:function(){return l.a.createElement("form",null,l.a.createElement("input",{type:"text",placeholder:"Search items",value:this.props.filterText,onChange:this.handleFilterTextChange}))}}]),t}(l.a.Component),y=a(74),x=a(75),I=a(84),v=function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return(a=Object(d.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(l)))).round5=function(e){return 5*Math.ceil(e/5)},a}return Object(f.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=parseFloat(this.props.items.map(function(e){return e.quantity*e.price}).reduce(function(e,t){return e+t},0).toFixed(2)),t=parseFloat((e*this.props.taxRate/100).toFixed(2)),a=parseFloat((t+e).toFixed(2)),n=this.props,r=n.filterText,i=n.addRow,s=n.items,c=n.handleInput,o=n.handleTaxRate;return l.a.createElement("div",null,l.a.createElement("h5",null,"Tabulated Receipt"),l.a.createElement(y.a,{size:"sm"},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"Item"),l.a.createElement("th",null,"Qty"),l.a.createElement("th",null,"Price"),l.a.createElement("th",null,"Subtotal"))),l.a.createElement("tbody",null,s.map(function(e,t){var a=parseFloat((e.price*e.quantity).toFixed(2));return-1===e.description.indexOf(r)?null:l.a.createElement("tr",{key:t},l.a.createElement("td",null,l.a.createElement("input",{name:"description",value:e.description,onChange:function(t){return c(t.target.name,t.target.value,e.itemId)}})),l.a.createElement("td",null,l.a.createElement("input",{name:"quantity",size:"2rem",value:e.quantity,onChange:function(t){return c(t.target.name,t.target.value,e.itemId)}})),l.a.createElement("td",null,l.a.createElement("input",{name:"price",size:"2rem",value:e.price,onChange:function(t){return c(t.target.name,t.target.value,e.itemId)}})),l.a.createElement("td",{className:"money"},a))}),l.a.createElement("tr",null,l.a.createElement("td",{className:"addItemCol"},l.a.createElement("button",{type:"button",className:"btn btn-success",onClick:i},"Add Item")),l.a.createElement("td",null),l.a.createElement("td",null,"Subtotal"),l.a.createElement("td",{className:"money"},e)),l.a.createElement("tr",null,l.a.createElement("td",null),l.a.createElement("td",null),l.a.createElement("td",null,l.a.createElement(x.a,null,l.a.createElement(I.a,{addonType:"prepend"},"Tax"),l.a.createElement("input",{name:"tax",value:this.props.taxRate,onChange:function(e){return o(e.target.value)}}),l.a.createElement(I.a,{addonType:"append"},"%"))),l.a.createElement("td",{className:"money"},t)),l.a.createElement("tr",null,l.a.createElement("td",null),l.a.createElement("td",null),l.a.createElement("td",null,"Total"),l.a.createElement("td",{className:"money"},a)))))}}]),t}(l.a.Component),O=a(76),j=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.item,n=t.personId,r=parseFloat((a.price*a.quantity).toFixed(2));return l.a.createElement("tr",null,l.a.createElement("td",null,a.description),l.a.createElement("td",{className:"quantityRow"},l.a.createElement(O.a,{className:"spinnerButtons",onClick:function(){return e.props.onReduceCount(n,a.itemId)}},"-"),l.a.createElement("span",{className:"px-1"},a.quantity),l.a.createElement(O.a,{className:"spinnerButtons",onClick:function(){return e.props.onAddCount(n,a.itemId)}},"+")),l.a.createElement("td",null,a.price),l.a.createElement("td",null,r))}}]),t}(l.a.Component),F=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this,t=this.props.taxRate,a=parseFloat(this.props.person.items.map(function(e){return e.quantity*e.price}).reduce(function(e,t){return e+t},0).toFixed(2)),n=parseFloat((a*t/100).toFixed(2)),r=(n+a).toFixed(2),i=this.props.person,s=this.props.filterText,c=[],o=null;return this.props.person.items.forEach(function(t){-1!==t.description.indexOf(s)&&t.description!==o&&(c.push(l.a.createElement(j,{personId:i.personId,item:t,key:t.itemId,onAddCount:e.props.onAddCount,onReduceCount:e.props.onReduceCount})),o=t.description)}),l.a.createElement("div",{className:"personPanel"},l.a.createElement("h5",null,i.name," ID: ",i.personId),l.a.createElement("table",null,l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"Item"),l.a.createElement("th",null,"Qty"),l.a.createElement("th",null,"Price"),l.a.createElement("th",null,"Subtotal"))),l.a.createElement("tbody",null,c,l.a.createElement("tr",null,l.a.createElement("td",null),l.a.createElement("td",null),l.a.createElement("td",null,"Subtotal"),l.a.createElement("td",{className:"money"},a)),l.a.createElement("tr",null,l.a.createElement("td",null),l.a.createElement("td",null),l.a.createElement("td",null,"Tax (",t,"%)"),l.a.createElement("td",{className:"money"},n)),l.a.createElement("tr",null,l.a.createElement("td",null),l.a.createElement("td",null),l.a.createElement("td",null,"Total"),l.a.createElement("td",{className:"money"},r)))),l.a.createElement("div",{className:"personButtons"},l.a.createElement("button",{className:"delete-btn",onClick:function(){return e.props.onDeletePerson(i.personId)}},"Delete person")))}}]),t}(l.a.Component),C=a(17),S=a.n(C),k=a(80),N=a(81),R=a(82),T=a(36),q=a.n(T),P=a(83),w=a(77),M=a(78),H=a(79),A=a(37),D=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).handleEmail=function(e){a.setState({emailValue:e.target.value})},a.handleSubmit=function(e){e.preventDefault();var t=A.validate(a.state.emailValue),n=a.props.selectedPerson,l=[];l.push("name ",n.name,"items ");for(var r=0;r<n.items.length;r++)n.items[r].quantity>0&&l.push("{",n.items[r].description,"qty: ",n.items[r].quantity,"@ ",n.items[r].price,"}");l.push("subtotal",n.subtotal,"tax",n.tax,"total",n.total);var i=JSON.stringify(l);t&&S()({method:"get",url:"https://hooks.zapier.com/hooks/catch/5311861/oyjxd9c",params:{email:a.state.emailValue,subject:"Message From Splits",message:i}}).then(function(e){var t=e.data.auth_token;localStorage.setItem("jwt",t),localStorage.setItem("current_user",JSON.stringify(e.data.user)),a.props.toggleEmailModal()}).catch(function(e){e&&a.setState({isLoading:!1})})},a.state={emailValue:""},a}return Object(f.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return l.a.createElement(l.a.Fragment,null,l.a.createElement(P.a,{isOpen:this.props.emailModal,toggle:this.props.toggleEmailModal},l.a.createElement(w.a,{toggle:this.props.toggleEmailModal},"Send Email"),l.a.createElement(M.a,null,l.a.createElement(H.a,{onSubmit:this.handleSubmit},l.a.createElement("div",{className:"form-group"},l.a.createElement("label",{htmlFor:"exampleInputEmail1"},"Email"),l.a.createElement("input",{value:this.state.emailValue,onChange:this.handleEmail,type:"email",className:"form-control",id:"exampleInputEmail1","aria-describedby":"emailHelp",placeholder:"Enter email"})),l.a.createElement(O.a,{type:"submit",color:"primary"},"Send Email")," ",l.a.createElement(O.a,{color:"secondary",onClick:this.props.toggleEmailModal},"Cancel")))))}}]),t}(l.a.Component),W=0,B=1,U=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).calcs=function(){var e=parseFloat(a.state.items.map(function(e){return e.quantity*e.price}).reduce(function(e,t){return e+t},0).toFixed(2)),t=parseFloat((e*a.state.taxRate/100).toFixed(2)),n=t+e;a.setState({subtotal:e,tax:t,total:n})},a.handleTaxRate=function(e){isNaN(e)?a.setState({taxRate:0}):(e=parseFloat(e),a.setState({taxRate:e},function(){return a.calcs()}))},a.handleAddPersonClick=function(){var e={name:"Person",personId:W++,items:[],subtotal:0,tax:0,total:0};for(var t in a.state.items)e.items.push({itemId:a.state.items[t].itemId,quantity:0,description:a.state.items[t].description,price:a.state.items[t].price});a.setState({persons:[].concat(Object(o.a)(a.state.persons),[e]),data:[].concat(Object(o.a)(a.state.data),[e])})},a.handleSendPersonEmail=function(e){a.setState(function(t){return{emailModal:!t.emailModal,selectedPerson:e}})},a.handleDeletePerson=function(e){var t=Object(o.a)(a.state.persons),n=t.findIndex(function(t){return t.personId===e});-1!==n&&(t.splice(n,1),a.setState({persons:t},function(){a.refreshRemainder()}))},a.updatePersonItems=function(){for(var e=Object(o.a)(a.state.items),t=Object(o.a)(a.state.persons),n=0;n<t.length;n++)for(var l=0;l<e.length;l++)t[n].items[l].description=e[l].description,t[n].items[l].price=e[l].price;a.setState({persons:t})},a.refreshRemainder=function(){for(var e=Object(o.a)(a.state.remainingItems),t=Object(c.a)({},a.state.user),n=0;n<a.state.items.length;n++){for(var l=Number(a.state.items[n].quantity),r=0;r<a.state.persons.length;r++)l-=a.state.persons[r].items[n].quantity;e[n]={itemId:a.state.items[n].itemId,description:a.state.items[n].description,price:a.state.items[n].price,quantity:l}}a.setState({remainingItems:e},function(){t.items=Object(o.a)(a.state.remainingItems),a.setState({user:t}),a.updatePersonItems()})},a.subtotalFunction=function(e){var t=a.state.subtotal,n=a.state.tax,l=a.state.total,r=Object(o.a)(a.state.persons),i=r.findIndex(function(t){return t.personId===e});r[i]=Object(c.a)({},r[i]);for(var s=0;s<r[i].items.length;s++)r[i].items[s].quantity>0&&(t+=parseFloat((r[i].items[s].quantity*r[i].items[s].price).toFixed(2)));n=parseFloat((.06*t).toFixed(2)),l=parseFloat((t+n).toFixed(2)),r[i].subtotal=t,r[i].tax=n,r[i].total=l,a.setState({persons:r})},a.handleAddCount=function(e,t){console.log("Add count - itemId: ".concat(t,", personId: ").concat(e));var n=Object(o.a)(a.state.persons),l=n.findIndex(function(t){return t.personId===e});n[l]=Object(c.a)({},n[l]);var r=n[l].items.findIndex(function(e){return e.itemId===t});0!==a.state.remainingItems[r].quantity&&(n[l].items[r]=Object(c.a)({},n[l].items[r]),n[l].items[r].quantity++,a.setState({persons:n},function(){return a.subtotalFunction(e)}),a.refreshRemainder())},a.handleReduceCount=function(e,t){console.log("Reduce count - itemId: ".concat(t,", personId: ").concat(e));var n=Object(o.a)(a.state.persons),l=n.findIndex(function(t){return t.personId===e});n[l]=Object(c.a)({},n[l]);var r=n[l].items.findIndex(function(e){return e.itemId===t});0!==n[l].items[r].quantity&&(n[l].items[r]=Object(c.a)({},n[l].items[r]),n[l].items[r].quantity--,a.setState({persons:n},function(){return a.subtotalFunction(e)}),a.refreshRemainder())},a.addRow=function(){for(var e={itemId:B++,price:0,quantity:0,description:""},t=[].concat(Object(o.a)(a.state.items),[e]),n=[].concat(Object(o.a)(a.state.remainingItems),[e]),l=Object(o.a)(a.state.persons),r=0;r<l.length;r++)l[r].items.push(e);a.setState({items:t,remainingItems:n,persons:l})},a.handleInput=function(e,t,n){var l=a.state.items.map(function(a){return Object(c.a)({},a,Object(s.a)({},e,a.itemId===n?"quantity"===e||"price"===e?parseFloat(t):t:a[e]))});a.setState({items:l},function(){return a.refreshRemainder()},a.calcs())},a.onChangeHandler=function(e){a.setState({selectedFile:e.target.files[0],loaded:0})},a.onClickHandler=function(){var e=new FormData;e.append("user_file",a.state.selectedFile),a.setState({loaded:.1}),S()({method:"POST",url:"http://localhost:5000/api/v1/detect/upload",data:e,headers:{"content-type":"multipart/form-data"}}).then(function(e){a.setState({imageUrl:e.data.url,imageWidth:parseInt(e.data.width),imageHeight:parseInt(e.data.height),receiptId:e.data.receiptId,loaded:1})}).catch(function(e){console.log(e)})},a.imageCoordFinder=function(e){var t=parseInt(e.nativeEvent.offsetX),n=parseInt(e.nativeEvent.offsetY),l=a.state,r=l.imageWidth,i=l.imageHeight,s=l.displayHeight,c=l.displayWidth;t=parseInt(t*r/c),n=parseInt(n*i/s),S()({method:"POST",url:"http://localhost:5000/api/v1/detect/".concat(a.state.receiptId),data:"".concat(t,", ").concat(n),headers:{"content-type":"text/plain"}}).then(function(e){if(console.log(e),"not found"!==e.data){var t={price:e.data.unit_price,quantity:e.data.quantity,description:e.data.description},n=a.checkExistingItem(t);if(-1!==n&&a.state.items.length>0){var l=Object(o.a)(a.state.items);l[n-1].quantity+=t.quantity,a.setState({items:l,remainingItems:l})}else t.itemId=B++,a.setState({items:[].concat(Object(o.a)(a.state.items),[t]),remainingItems:[].concat(Object(o.a)(a.state.remainingItems),[t])})}}).catch(function(e){console.log(e)})},a.checkExistingItem=function(e){for(var t=0;t<a.state.items.length;t++)if(a.state.items[t].description===e.description&&a.state.items[t].price===e.price)return console.log(a.state.items[t].itemId),a.state.items[t].itemId;return-1},a.onImgLoad=function(e){var t=e.target;a.setState({displayHeight:t.offsetHeight,displayWidth:t.offsetWidth})},a.state={filterText:"",items:[],persons:[],remainingItems:[],rounding:0,emailModal:!1,data:[],user:[],selectedPerson:{},subtotal:0,tax:0,total:0,selectedFile:null,imageWidth:0,imageHeight:0,displayWidth:0,displayHeight:0,loaded:0,taxRate:0},a.handleFilterTextChange=a.handleFilterTextChange.bind(Object(h.a)(a)),a}return Object(f.a)(t,e),Object(m.a)(t,[{key:"isFloat",value:function(e){return e===+e&&e!==(0|e)}},{key:"handleFilterTextChange",value:function(e){this.setState({filterText:e})}},{key:"componentDidMount",value:function(){var e={name:"User",userId:0,items:Object(o.a)(this.state.items),subtotal:0,tax:0,total:0};this.setState({user:e,data:[].concat(Object(o.a)(this.state.data),[e])})}},{key:"componentDidUpdate",value:function(){}},{key:"render",value:function(){var e=this,t=this.state,a=t.items,n=t.imageUrl,r=t.loaded,i=t.filterText,s=t.persons,c=t.remainingItems,o=this.onChangeHandler,u=this.onClickHandler,m=this.onImgLoad,d=this.imageCoordFinder,p=this.addRow,h=this.handleFilterTextChange,f=this.handleInput,E=this.handleAddPersonClick,y=this.handleDeletePerson,x=this.handleAddCount,I=this.handleReduceCount,O=this.handleTaxRate;return l.a.createElement("div",null,l.a.createElement(k.a,null,l.a.createElement(N.a,{md:"6",style:{height:"100vh"},className:"receiptDisplay"},n||0!==r?l.a.createElement("div",{className:"h-100"},1!==r?l.a.createElement(R.a,{className:"h-100 d-flex justify-content-center align-items-center"},l.a.createElement("img",{src:q.a,alt:""})):l.a.createElement("div",null,l.a.createElement("img",{src:n,id:"pic",onLoad:m,onClick:d,alt:"",style:{width:"100%"}}))):l.a.createElement(R.a,{className:"h-100 d-flex justify-content-center align-items-center"},l.a.createElement("div",{className:"fileInputGroup form-group files d-flex flex-column justify-content-center w-50"},l.a.createElement("label",null,"Upload Receipt Image "),l.a.createElement("input",{type:"file",className:"fileInput",name:"file",onChange:o}),l.a.createElement("button",{type:"button",className:"btn btn-success justify-self-center",onClick:u},"Upload")))),l.a.createElement(N.a,{md:"6"},l.a.createElement(R.a,{className:"searchBar w-50 mb-2 d-flex justify-content-center align-items-center"},l.a.createElement(b,{filterText:i,onFilterTextChange:h})),l.a.createElement(v,{items:a,filterText:i,handleInput:f,addRow:p,taxRate:this.state.taxRate,handleTaxRate:O}),l.a.createElement("h5",null,"Other's Split"),l.a.createElement("button",{type:"button",className:"btn btn-success",onClick:E},"Add Person"),l.a.createElement("div",{className:"personPanelHolder"},s.map(function(t,a){return l.a.createElement(F,{key:a,person:t,onDeletePerson:y,onAddCount:x,onReduceCount:I,onSendPersonEmail:e.handleSendPersonEmail,taxRate:e.state.taxRate,filterText:i})})),l.a.createElement(g,{handleInput:f,remainingItems:c,filterText:i,rounding:this.state.rounding,subtotal:this.state.subtotal,tax:this.state.tax,total:this.state.total,taxRate:this.state.taxRate}))),l.a.createElement(D,{emailModal:this.state.emailModal,toggleEmailModal:this.handleSendPersonEmail,selectedPerson:this.state.selectedPerson}))}}]),t}(l.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(72);i.a.render(l.a.createElement(U,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[39,1,2]]]);
//# sourceMappingURL=main.75a03b3a.chunk.js.map